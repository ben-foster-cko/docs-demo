post:
  tags:
    - Payments
  summary: Request a payment
  description: |
    Request a payment from a new or existing source. 

    ### Payment Source

    To use an existing payment source such as a card or SEPA mandate, provide the source identifier.

    ```
    {
      "source": {
        "id": "src_wmlfc3zyhqzehihu7giusaaawu"
      }
    }
    ```

    #### Full Card (PCI Compliant Merchants)

    ```
    {
      "source": {
        "card": {
          "number": "4543474002249996",
          "expiry_month": 6,
          "expiry_year": 2025,
          "name": "Bruce Wayne",
          "cvv": "956"
        }
      }
    }
    ```

    ### Card Token (Checkout Frames and Digital Wallets)

    ```
    {
      "source": {
        "token": {
          "id": "tok_ubfj2q76miwundwlk72vxt2i7q",
          "billing_address": {
            // ...
          }
        }
      }
    }
    ```

    ### Customer

    When a customer source is specified we will use the customer's default card source for the payment. 
    You can also provide the customer's email address if the customer identifier is unknown.

    ```
    {
      "source": {
        "customer": {
          "id": "cus_y3oqhf46pyzuxjbcn2giaqnb44"
        }
      }
    }
    ```

    ### Alternative Payments

    To use an Alternative Payment as a source provide an object for the appropriate Alternative Payment name. This can also include any additional data as required by the Alternative Payment method.

    ```
    {
      "source": {
        "ideal": {
          "issuer_id": "xxx"
        }
      }
    }
    ```

    ### Redirect payments

    Some payment requests may require the owner to be redirected to a third party site prior to completing the payment, for example, 3D-Secure payments will redirect the card holder to the issuer's 3D-Secure page. In these cases a HTTP 202 response will be returned, containing a redirect link.

  parameters:
    - name: body
      in: body
      required: true
      schema:
        $ref: '#/definitions/PaymentRequest'
  responses:
    '201':
      description: Payment processed successfully
      schema:
        $ref: '#/definitions/PaymentResponse'
      headers:
        Cko-Request-Id:
          $ref: "#/headers/Cko-Request-Id"
        Cko-Version:
          $ref: "#/headers/Cko-Version"
    '202':
      description: Payment accepted but requires input from the owner
      schema:
        $ref: '#/definitions/PaymentRedirectResponse'
      headers:
        Cko-Request-Id:
          $ref: "#/headers/Cko-Request-Id"
        Cko-Version:
          $ref: "#/headers/Cko-Version"
    '401':
      description: Unauthorized
    '422':
      $ref: '#/responses/InvalidDataError'
        
# get:
#   tags:
#     - Charges
#   summary: Retrieve a list of charges
#   description: |
#     Retrieve a list of charges
#   parameters:
#     - $ref: '#/parameters/collectionLimit'
#     - $ref: '#/parameters/collectionOffset'
#   responses:
#     '200':
#       description: A list of charges was retrieved successfully
#       schema:
#         type: array
#         items:
#           $ref: '#/definitions/Charge'
#     '401':
#       $ref: '#/responses/AccessForbidden'
